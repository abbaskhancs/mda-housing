{"level":"error","message":"Login error: JWT_SECRET not configured","service":"mda-housing-api","stack":"Error: JWT_SECRET not configured\n    at generateToken (C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\auth.js:37:15)\n    at C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\auth.js:88:23","timestamp":"2025-09-06T11:22:39.279Z"}
{"level":"error","message":"Login error: JWT_SECRET not configured","service":"mda-housing-api","stack":"Error: JWT_SECRET not configured\n    at generateToken (C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\auth.js:37:15)\n    at C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\auth.js:88:23","timestamp":"2025-09-06T11:23:46.026Z"}
{"level":"error","message":"Login error: JWT_SECRET not configured","service":"mda-housing-api","stack":"Error: JWT_SECRET not configured\n    at generateToken (C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\auth.js:37:15)\n    at C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\auth.js:91:23","timestamp":"2025-09-06T11:24:45.932Z"}
{"level":"error","message":"GUARD_INTAKE_COMPLETE error: Database error","service":"mda-housing-api","stack":"Error: Database error\n    at Object.<anonymous> (C:\\Abbas\\Coding\\MDA_Housing\\backend\\src\\test\\guards.test.ts:674:51)\n    at Promise.then.completed (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-runner\\build\\runTest.js:444:34)","timestamp":"2025-09-06T18:36:03.384Z"}
{"error":"Application not found","ip":"::1","level":"error","message":"Error occurred:","method":"GET","service":"mda-housing-api","stack":"Error: Application not found\n    at createError (C:\\Abbas\\Coding\\MDA_Housing\\dist\\middleware\\errorHandler.js:18:12)\n    at C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\workflow.js:165:50","timestamp":"2025-09-06T18:38:19.528Z","url":"/api/workflow/transitions?from=SUBMITTED&applicationId=cmf8lxa6w000cmtio1fmqqh1d&dryRun=true","userAgent":"node"}
{"error":"Application not found","ip":"::1","level":"error","message":"Error occurred:","method":"GET","service":"mda-housing-api","stack":"Error: Application not found\n    at createError (C:\\Abbas\\Coding\\MDA_Housing\\dist\\middleware\\errorHandler.js:18:12)\n    at C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\workflow.js:165:50","timestamp":"2025-09-06T18:38:19.595Z","url":"/api/workflow/transitions?from=SUBMITTED&applicationId=cmf8lxa6w000cmtio1fmqqh1d&dryRun=true","userAgent":"node"}
{"error":"Application not found","ip":"::1","level":"error","message":"Error occurred:","method":"POST","service":"mda-housing-api","stack":"Error: Application not found\n    at createError (C:\\Abbas\\Coding\\MDA_Housing\\dist\\middleware\\errorHandler.js:18:12)\n    at C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\workflow.js:313:46","timestamp":"2025-09-06T18:38:19.618Z","url":"/api/workflow/applications/cmf8lxa6w000cmtio1fmqqh1d/transition","userAgent":"node"}
{"error":"Application not found","ip":"::1","level":"error","message":"Error occurred:","method":"GET","service":"mda-housing-api","stack":"Error: Application not found\n    at createError (C:\\Abbas\\Coding\\MDA_Housing\\dist\\middleware\\errorHandler.js:18:12)\n    at C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\workflow.js:165:50","timestamp":"2025-09-06T18:38:19.640Z","url":"/api/workflow/transitions?from=UNDER_SCRUTINY&applicationId=cmf8lxa6w000cmtio1fmqqh1d&dryRun=true","userAgent":"node"}
{"error":"Application not found","ip":"::1","level":"error","message":"Error occurred:","method":"POST","service":"mda-housing-api","stack":"Error: Application not found\n    at createError (C:\\Abbas\\Coding\\MDA_Housing\\dist\\middleware\\errorHandler.js:18:12)\n    at C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\applications.js:505:46","timestamp":"2025-09-06T18:38:19.659Z","url":"/api/applications/cmf8lxa6w000cmtio1fmqqh1d/clearances","userAgent":"node"}
{"error":"Application not found","ip":"::1","level":"error","message":"Error occurred:","method":"POST","service":"mda-housing-api","stack":"Error: Application not found\n    at createError (C:\\Abbas\\Coding\\MDA_Housing\\dist\\middleware\\errorHandler.js:18:12)\n    at C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\applications.js:505:46","timestamp":"2025-09-06T18:38:19.677Z","url":"/api/applications/cmf8lxa6w000cmtio1fmqqh1d/clearances","userAgent":"node"}
{"error":"Application not found","ip":"::1","level":"error","message":"Error occurred:","method":"POST","service":"mda-housing-api","stack":"Error: Application not found\n    at createError (C:\\Abbas\\Coding\\MDA_Housing\\dist\\middleware\\errorHandler.js:18:12)\n    at C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\applications.js:887:46","timestamp":"2025-09-06T18:38:19.719Z","url":"/api/applications/cmf8lxa6w000cmtio1fmqqh1d/transfer-deed/draft","userAgent":"node"}
{"error":"Application not found","ip":"::1","level":"error","message":"Error occurred:","method":"POST","service":"mda-housing-api","stack":"Error: Application not found\n    at createError (C:\\Abbas\\Coding\\MDA_Housing\\dist\\middleware\\errorHandler.js:18:12)\n    at C:\\Abbas\\Coding\\MDA_Housing\\dist\\routes\\applications.js:955:46","timestamp":"2025-09-06T18:38:19.730Z","url":"/api/applications/cmf8lxa6w000cmtio1fmqqh1d/transfer-deed/finalize","userAgent":"node"}
{"level":"error","message":"GUARD_INTAKE_COMPLETE error: Database error","service":"mda-housing-api","stack":"Error: Database error\n    at Object.<anonymous> (C:\\Abbas\\Coding\\MDA_Housing\\backend\\src\\test\\guards.test.ts:674:51)\n    at Promise.then.completed (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\utils.js:231:10)\n    at _callCircusTest (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\run.js:252:3)\n    at _runTestsForDescribeBlock (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\run.js:126:9)\n    at _runTestsForDescribeBlock (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at _runTestsForDescribeBlock (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\run.js:121:9)\n    at run (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\run.js:71:3)\n    at runAndTransformResultsToJestFormat (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapterInit.js:122:21)\n    at jestAdapter (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-circus\\build\\legacy-code-todo-rewrite\\jestAdapter.js:79:19)\n    at runTestInternal (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-runner\\build\\runTest.js:367:16)\n    at runTest (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-runner\\build\\runTest.js:444:34)\n    at Object.worker (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\jest-runner\\build\\testWorker.js:106:12)","timestamp":"2025-09-06T18:44:41.327Z"}
{"clientVersion":"5.22.0","code":"P2003","level":"error","message":"Failed to generate document: \nInvalid `prisma.document.upsert()` invocation in\nC:\\Abbas\\Coding\\MDA_Housing\\backend\\src\\services\\documentService.ts:84:46\n\n  81 const downloadUrl = storageService.generateDownloadUrl(applicationId, expiresInHours * 3600);\n  82 \n  83 // Save to database\n→ 84 const document = await prisma.document.upsert(\nForeign key constraint violated: `foreign key`","meta":{"field_name":"foreign key","modelName":"Document"},"name":"PrismaClientKnownRequestError","service":"mda-housing-api","stack":"PrismaClientKnownRequestError: \nInvalid `prisma.document.upsert()` invocation in\nC:\\Abbas\\Coding\\MDA_Housing\\backend\\src\\services\\documentService.ts:84:46\n\n  81 const downloadUrl = storageService.generateDownloadUrl(applicationId, expiresInHours * 3600);\n  82 \n  83 // Save to database\n→ 84 const document = await prisma.document.upsert(\nForeign key constraint violated: `foreign key`\n    at $n.handleRequestError (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\@prisma\\client\\runtime\\library.js:121:7315)\n    at $n.handleAndLogRequestError (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\@prisma\\client\\runtime\\library.js:121:6623)\n    at $n.request (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\@prisma\\client\\runtime\\library.js:121:6307)\n    at async l (C:\\Abbas\\Coding\\MDA_Housing\\node_modules\\@prisma\\client\\runtime\\library.js:130:9633)\n    at async DocumentService.generateDocument (C:\\Abbas\\Coding\\MDA_Housing\\backend\\src\\services\\documentService.ts:84:24)\n    at async testSignedDownloads (C:\\Abbas\\Coding\\MDA_Housing\\test-signed-downloads.temp.ts:60:27)","timestamp":"2025-09-06T19:07:16.737Z"}
{"code":"ENOENT","errno":-4058,"level":"error","message":"Failed to download file: ENOENT: no such file or directory, open 'C:\\Abbas\\Coding\\MDA_Housing\\storage\\C:\\Abbas\\Coding\\MDA_Housing\\storage\\documents\\1757187642401-a8e1a2443f2699b2-milestone-test-file.pdf'","path":"C:\\Abbas\\Coding\\MDA_Housing\\storage\\C:\\Abbas\\Coding\\MDA_Housing\\storage\\documents\\1757187642401-a8e1a2443f2699b2-milestone-test-file.pdf","service":"mda-housing-api","stack":"Error: ENOENT: no such file or directory, open 'C:\\Abbas\\Coding\\MDA_Housing\\storage\\C:\\Abbas\\Coding\\MDA_Housing\\storage\\documents\\1757187642401-a8e1a2443f2699b2-milestone-test-file.pdf'\n    at async open (node:internal/fs/promises:639:25)\n    at async Object.readFile (node:internal/fs/promises:1243:14)\n    at async FileStorageService.downloadFile (C:\\Abbas\\Coding\\MDA_Housing\\dist\\services\\fileStorageService.js:53:28)\n    at async testMilestone31 (C:\\Abbas\\Coding\\MDA_Housing\\test-milestone-3-1-simple.js:336:32)","syscall":"open","timestamp":"2025-09-06T19:40:42.419Z"}
